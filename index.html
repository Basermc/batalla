<script>
    async function finalizar() {
        const tabla = document.getElementById('tablaPuntuacion');
        const filas = tabla.querySelectorAll('tr');
        const resultados = [];
        
        filas.forEach((fila, index) => {
            if (index === 0) return; // Saltar la fila de encabezado
            const nombre = fila.querySelector('input[type="text"]').value;
            const puntuaciones = [];
            fila.querySelectorAll('input[type="number"]').forEach(input => {
                puntuaciones.push(parseInt(input.value) || 0);
            });
            const total = parseInt(fila.querySelector('.total').innerText);
            resultados.push({ nombre, puntuaciones, total });
        });

        const nombreJurado = prompt("Introduce tu nombre de jurado:");
        const jsonContent = JSON.stringify(resultados, null, 2);

        const response = await fetch('https://YOUR_FUNCTION_URL.netlify.app/.netlify/functions/trigger-workflow', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                filename: `${nombreJurado}.json`,
                content: jsonContent
            })
        });

        if (response.ok) {
            alert('Resultados enviados para guardar en el repositorio.');
        } else {
            alert('Hubo un problema al enviar los resultados.');
            console.error(await response.text());
        }
    }
</script>
